# ロードマップ

> 最終更新: 2026-02-13

## フェーズ一覧

| Phase | 内容 | 状態 | 備考 |
|-------|------|------|------|
| **A** | はじめの英文読解ドリル構造化（Ch01-06） | **完了** | 84ノード・498英文（粒度調整後） |
| **B** | 知識ノード品質改善（AI主導の粒度・難易度修正） | **完了** | 粒度調整71→84ノード、check_points構造化完了 |
| **B'** | 知識ノード品質改善（人間主導の内容修正） | 未着手 | C完了後に開始。講師目線でAIと相談しながら継続的に改善 |
| **C** | 確認テスト生成API | **完了** | Cloud Run デプロイ済み、GAS統合完了、実運用開始 |
| **D** | Exam_01, Exam_02 構造化 | 未着手 | |
| **E** | Webアプリ（閲覧）+ DB移行 | **進行中** | E-1完了、E-2/E-3並行開発中 |
| **F** | 他参考書マッピング（核心・成川等） | 未着手 | |
| **G** | 生徒習熟度管理・SM-2 | 未着手 | |

## タイムライン

```
完了 ──── Phase A〜C ──── 実運用開始（2026-02-13）──→
                              │
                              ├── B'開始 ──── B'継続（長期）──→
                              └── Phase E 開始（2026-02-13）
                                   E-1完了 → E-2+E-3並行開発中 → E-4
```

## 実運用開始の条件（すべて達成済み）

- ~~Phase C（確認テスト生成API）が完了し、GASから呼び出せる状態~~ → 完了
- ~~GAS統合（呼び出し側スクリプト）の実装~~ → 完了（スプレッドシートUIから生成可能）
- ~~Phase B の粒度修正が一段落している~~ → 完了

## 各フェーズの詳細

### Phase A: 構造化（完了）
- 「はじめの英文読解ドリル」Ch01〜Ch06の全39セクション
- 知識ノード84件（粒度調整後）、英文498件、5カテゴリ
- 設計: [構造化設計案](design/構造化設計案_はじめの英文読解ドリル.md)
- ワークフロー: [作業ワークフロー](design/作業ワークフロー.md)
- ログ: [作業ログ](log/作業ログ.md)

### Phase B: 知識ノード品質改善（AI主導）（完了）
- 粒度調整: 71→84ノード。全Chapter 2.0ノード/セクション以上に統一
- check_points構造化: 文字列形式 → question/answer dict形式に全84ノード変換
- 難易度（priority）の見直し

### Phase B': 知識ノード品質改善（人間主導）
- 講師目線での内容修正
- 知識の必要性判断、表現の調整
- AIと相談しながら継続的に改善
- 終わりが明確でなく、運用しながら磨き続ける

### Phase C: 確認テスト生成API（完了）
- 設計: [確認テスト生成API設計書](design/確認テスト生成API_設計書.md)
- 改善指示: [確認テスト改善指示書](design/確認テスト改善_指示書.md)
- 実装完了（FastAPI + Jinja2 + WeasyPrint + GCS）、68テスト全GREEN
- 4つの改善を適用済み:
  1. ウォームアップ問題（前提知識の復習）
  2. 英文問題に着眼点（どの知識を使うか表示）
  3. ノード単位のセット出題（知識確認→英文を紐付け）
  4. 解答の逆引きガイド（間違えた時の復習先）
- 出題アルゴリズム改善（2026-02-12）:
  - ランダム化: ウォームアップ/知識確認/英文の選出を毎回シャッフル
  - 英文問題の全体上限(target_max=6)を撤廃、ノードあたり最大1文のみに変更
- PDF統合: 問題+解答を1つのPDFに統合（改ページで区切り）
- **デプロイ済み（2026-02-12）**:
  - GCP Cloud Run（asia-northeast1）
  - API: `https://seras-test-generator-hif2eccama-an.a.run.app`
  - PDF保存: GCS（`gs://seras-test-pdfs`、公開URL）
  - GCPプロジェクト: `seras-test-generator`
  - CI/CD: GitHub Actions（main push → 自動デプロイ）
- **GAS統合完了（2026-02-13）**: スプレッドシートからセクション範囲を指定してPDF生成可能
- **実運用開始（2026-02-13）**

### Phase D: Exam構造化
- Exam_01（p.152-155）、Exam_02（p.156-159）
- 複数知識が複合する入試演習問題

### Phase E: Webアプリ（閲覧）+ DB移行（進行中）
- **E-1: Supabase セットアップ + データ移行（完了）**
  - Supabase (PostgreSQL, Tokyo) に 11テーブル作成
  - YAML → DB インポート完了（84ノード、498英文、39セクション）
  - データ整合性検証スクリプトで全チェック通過
- **E-2: FastAPI テスト生成API の DB 移行（進行中）**
  - SupabaseDataStore 実装、既存テスト維持
- **E-3: Next.js 閲覧アプリ構築（進行中）**
  - seras-knowledge-viewer（新規リポジトリ）
  - Next.js + CSS Modules + Supabase JS Client
  - 6ページ: ダッシュボード、ノード一覧/詳細、セクション一覧/詳細、英文検索
- **E-4: クリーンアップ（未着手）**
  - YAML削除、Dockerfile簡素化、CI/CD更新
- 設計: [Phase E 設計案](design/Phase_E_設計案.md)

### Phase F: 他参考書マッピング
- 核心、成川、スクランブル、肘井、入門精講
- knowledge/は共通、mappings/を参考書ごとに追加

### Phase G: 生徒習熟度管理
- SM-2アルゴリズムによる間隔反復
- 生徒×知識ノードの習熟度DB
